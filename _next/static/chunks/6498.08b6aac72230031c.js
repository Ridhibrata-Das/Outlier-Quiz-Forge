"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6498],{82453:function(e,t,r){var a=r(85893),l=r(67294),o=r(3751),n=r(95774);r(19646);var s=r(52104),i=r(9473);let d=(0,l.forwardRef)((e,t)=>{let{timerSeconds:r,onTimerExpire:d}=e,c=new Date;c.setSeconds(c.getSeconds()+r);let m=(0,i.v9)(s.bh),u=m&&(null==m?void 0:m.primary_color),{seconds:h,restart:v,start:x,minutes:p,pause:_,hours:y}=(0,o.useTimer)({expiryTimestamp:c,autoStart:!0,onExpire:()=>{setTimeout(()=>{d()},500)}});(0,l.useImperativeHandle)(t,()=>({startTimer(){x()},resetTimer(){let e=new Date;e.setSeconds(e.getSeconds()+r),v(e)},pauseTimer(){_()},getTimerSeconds:()=>h,getMinuteandSeconds:()=>"".concat(y,":").concat(p,":").concat(h)}));let g=100/r,f=0;f=r<=60?g*h:r>=60&&r<=3600?g*(h+60*p):g*(h+60*p+3600*y);let j="#ef5388";return r<=60&&h<=10?j="red":0===y&&0===p&&r>=60&&r<=3600&&h<=10&&(j="red"),(0,a.jsx)("div",{className:"coinsdata",children:(0,a.jsx)("div",{className:"progressbar-container adj_timer_for_ui",children:(0,a.jsx)(n.Ip,{value:f,text:0===y&&0===p?"".concat(h):0===y?"".concat(p,":").concat(h):"".concat(y,":").concat(p,":").concat(h),styles:(0,n.y3)({textSize:"16px",textColor:u,pathColor:j,trailColor:"#d6d6d6",circleTop:"0%"})})})})});t.Z=d},16498:function(e,t,r){r.r(t);var a=r(85893),l=r(67294),o=r(91768),n=r(86501),s=r(9661),i=r(81702),d=r(82305),c=r(9473),m=r(54074),u=r(9559),h=r(89886),v=r(52984),x=r(27262),p=r(39332),_=r(79326),y=r(82453);r(5152);var g=r(74274),f=r(36609),j=r(39828);t.default=(0,o.Z)()(()=>{var e,t,r,o,b,N,w,S,Z,T,P;let C=(0,c.v9)(e=>e.User),E=(0,c.I0)(),k=(0,j.ad)(),I=(0,c.v9)(h.Aj),U=(0,c.v9)(v.fg),A=(0,c.v9)(m.zl),[R,B]=(0,l.useState)({all:"",selected:"",category_name:""}),J=null==A?void 0:A.battle_mode_random_entry_coin,F=A&&A.bot_image,[D,M]=(0,l.useState)(!0),[z,Y]=(0,l.useState)(!1),[H,q]=(0,l.useState)(!1),[L,O]=(0,l.useState)(!1),[$,V]=(0,l.useState)(!1),[W,G]=(0,l.useState)({userName:"",profile:""}),K=C&&Number(null==C?void 0:null===(e=C.data)||void 0===e?void 0:e.coins),Q=(0,l.useRef)(null),X=(0,p.useRouter)(),ee=I.id,et=A&&"1"==A.battle_mode_random_category?R.selected:"",er=(null==C?void 0:null===(t=C.data)||void 0===t?void 0:t.name)||(null==C?void 0:null===(r=C.data)||void 0===r?void 0:r.email)||(null==C?void 0:null===(o=C.data)||void 0===o?void 0:o.mobile),ea=(null==C?void 0:null===(b=C.data)||void 0===b?void 0:b.profile)?null==C?void 0:null===(N=C.data)||void 0===N?void 0:N.profile:"",el=null==C?void 0:null===(w=C.data)||void 0===w?void 0:w.id,eo=J&&Number(J),en=Number(null==A?void 0:A.battle_mode_random_search_duration),es=()=>{(0,u.Yc)({type:1,sub_type:2,onSuccess:e=>{let t=e.data.filter(e=>"0"===e.is_premium);B({...R,all:t,selected:t[0].id,category_name:t[0].category_name}),M(!1)},onError:e=>{M(!1),console.log(e)}})},ei=e=>{let t=e.target.selectedIndex,r=e.target.childNodes[t],a=r.getAttribute("id"),l=r.getAttribute("name");B({...R,selected:a,category_name:l})},ed=async(e,t,r,a,l,o,s,i)=>{try{let o=(0,j.ET)((0,j.hJ)(k,"battleRoom"),{categoryId:e,createdAt:(0,j.Bt)(),createdBy:a,entryFee:s||0,languageId:i,readyToPlay:!1,roomCode:l||"",playwithRobot:!0,user1:{answers:[],name:t,points:0,profileUrl:r,uid:a,correctAnswers:0},user2:{answers:[],name:(0,f.t)("botname"),points:0,profileUrl:F,uid:"000",correctAnswers:0}});return await o}catch(e){n.ZP.error(e)}},ec=async(e,t,r,a,l,o,s,i)=>{try{let o=(0,j.ET)((0,j.hJ)(k,"battleRoom"),{categoryId:e,createdAt:(0,j.Bt)(),createdBy:a,entryFee:s||0,languageId:i,categoryName:null==R?void 0:R.category_name,readyToPlay:!1,roomCode:l||"",user1:{answers:[],name:t,points:0,profileUrl:r,uid:a,correctAnswers:0},user2:{answers:[],name:"",points:0,profileUrl:"",uid:"",correctAnswers:0}});return await o}catch(e){console.log(e),n.ZP.error(e)}},em=async e=>{try{await (0,j.oe)((0,j.JU)(k,"battleRoom",e))}catch(e){n.ZP.error(e)}},eu=async(e,t)=>{try{let r=(0,j.IO)((0,j.hJ)(k,"battleRoom"),(0,j.ar)("languageId","==",e),(0,j.ar)("categoryId","==",t),(0,j.ar)("roomCode","==",""),(0,j.ar)("user2.uid","==","")),a=(await (0,j.PL)(r)).docs,l=a.findIndex(e=>e.data().createdBy==el);return -1!==l&&(em(a[l].id),a.splice(l,1)),a}catch(e){n.ZP.error("Error getting document",e),console.log(e)}},eh=async(e,t,r,a)=>{try{let l=(0,j.JU)(k,"battleRoom",a);await (0,j.i3)(k,async a=>{let o=await a.get(l);if(!o.exists())throw Error("Document does not exist!");let{user2:n}=o.data();return(0,v.yB)("totalusers",2),""!==n.uid||(a.update(l,{"user2.name":e,"user2.uid":r,"user2.profileUrl":t}),!1)})}catch(e){n.ZP.error(e.message),console.log(e)}},ev=async(e,t,r,a)=>{try{let l=(0,j.JU)(k,"battleRoom",a);await (0,j.i3)(k,async a=>{let o=await a.get(l);if(!o.exists())throw Error("Document does not exist!");let{user2:n}=o.data();return(0,v.yB)("totalusers",2),""!==n.uid||(a.update(l,{"user2.name":e,"user2.uid":r,"user2.profileUrl":t}),!1)})}catch(e){n.ZP.error(e.message),console.log(e)}},ex=()=>{V(!1),O(!0)},ep=e=>{try{if(!e)return;let t=(0,j.JU)(k,"battleRoom",e);return(0,j.cf)(t,{includeMetadataChanges:!0},e=>{if(e.exists&&e.data()){var t;let r=e.data(),{user2:a}=r,l=a.uid;""!==l?(Y(!0),ex()):V(!0),(null==C?void 0:null===(t=C.data)||void 0===t?void 0:t.id)===r.user1.uid?G({...W,userName:r.user2.name,profile:r.user2.profileUrl}):G({...W,userName:r.user1.name,profile:r.user1.profileUrl})}},e=>{console.log("err",e),n.ZP.error(e.message)})}catch(e){console.error("An error occurred:",e),n.ZP.error("An error occurred while subscribing to the battle room.")}};(0,l.useEffect)(()=>{ep()},[]);let e_=async()=>{var e;if("0"===K&&K<0){Y(!1);return}return(null==C?void 0:null===(e=C.data)||void 0===e?void 0:e.coins)<eo?(n.ZP.error((0,f.t)("You dont have enough coins")),!1):(await ec(et,er,ea,el,"","public",eo,ee)).id},ey=async()=>{var e;if("0"===K&&K<0){Y(!1);return}return(null==C?void 0:null===(e=C.data)||void 0===e?void 0:e.coins)<eo?(n.ZP.error((0,f.t)("You dont have enough coins")),!1):(await ed(et,er,ea,el,"","public",eo,ee)).id},eg=async()=>{var e;if("0"===K&&K<0){Y(!1);return}if((null==C?void 0:null===(e=C.data)||void 0===e?void 0:e.coins)<=eo)return n.ZP.error((0,f.t)("You dont have enough coins")),!1;try{let e,t=await eu(ee,et,er,ea,el);t&&t.length>0?(e=t[Math.floor(Math.random()*(null==t?void 0:t.length))].id,await eh(er,ea,el,e)?eg(ee,et,er,ea,el):ep(e)):e=await e_(),Y(!0),ep(e),(0,v.yB)("roomid",e)}catch(e){n.ZP.error(e)}},ef=async()=>{if("0"===K&&K<0){Y(!1);return}try{let e,t=await eu(ee,et,er,ea,el);t&&t.length>0?(e=t[Math.floor(Math.random()*(null==t?void 0:t.length))].id,await ev(er,ea,el,e)?ef(ee,et,er,ea,el):ep(e)):e=await ey(),Y(!0),ep(e),(0,v.yB)("roomid",e)}catch(e){n.ZP.error(e),console.log(e)}},ej=()=>{q(!1),Q.current.resetTimer(),eg(),(0,v.$J)(!1)},eb=()=>{q(!1),Q.current.resetTimer(),ef(),(0,v.$J)(!0)},eN=()=>{X.push({pathname:"/random-battle/play-with-friend-battle"}),(0,x.cE)({category_id:et,language_id:ee})};(0,l.useEffect)(()=>{es(),E((0,x.e5)(!1))},[h.Aj]);let ew=()=>{X.push("/quiz-play")};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(_.Z,{title:(0,f.t)("1 v/s 1 Battle"),content:"",contentTwo:""}),(0,a.jsx)("div",{className:"SelfLearning battlequiz my-5",children:(0,a.jsx)("div",{className:"container",children:(0,a.jsx)("div",{className:"row morphisam",children:z?(0,a.jsx)("div",{className:"col-md-8 col-12 mx-auto",children:(0,a.jsx)("div",{className:"randomplayer",children:(0,a.jsxs)("div",{className:"main_screen",children:[(0,a.jsxs)("div",{className:"timer text-center",children:[$?(0,a.jsx)(y.Z,{ref:Q,timerSeconds:en,onTimerExpire:()=>{em(U.roomID),q(!0)}}):"",L?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(y.Z,{ref:Q,timerSeconds:3,onTimerExpire:()=>{let e=U.roomID;X.push({pathname:"/random-battle/random-play"}),(0,x.Vm)({category_id:et,room_id:e,destroy_match:"0"})}}),(0,a.jsx)("p",{className:"text-dark",children:(0,f.t)("lets_get_started")})]}):""]}),(0,a.jsxs)("div",{className:"inner_Screen onevsonescreen",children:[(0,a.jsxs)("div",{className:"user_profile",children:[(0,a.jsx)("img",{src:null==C?void 0:null===(S=C.data)||void 0===S?void 0:S.profile,alt:"wrteam",onError:s.HS}),(0,a.jsx)("p",{className:"mt-3 text-dark",children:(null==C?void 0:null===(Z=C.data)||void 0===Z?void 0:Z.name)||(null==C?void 0:null===(T=C.data)||void 0===T?void 0:T.email)||(null==C?void 0:null===(P=C.data)||void 0===P?void 0:P.mobile)})]}),(0,a.jsx)("div",{className:"vs_image",children:(0,a.jsx)("img",{src:g.Z.src,alt:"versus"})}),(0,a.jsxs)("div",{className:"opponent_image",children:[(0,a.jsx)("img",{src:void 0===W.profile?"":W.profile,alt:"wrteam",onError:s.HS}),(0,a.jsx)("p",{className:"mt-3 text-dark",children:void 0===W.userName?"waiting...":W.userName})]})]})]})})}):(0,a.jsxs)(a.Fragment,{children:[(null==A?void 0:A.battle_mode_random)==="1"?(0,a.jsx)("div",{className:"col-md-12 col-lg-6 col-12",children:(0,a.jsx)("div",{className:"left_content",children:(0,a.jsxs)("div",{className:"left-sec right_content",children:[(0,a.jsx)("h3",{className:" mb-3 leftSecTite",children:(0,f.t)("random_battle")}),(0,a.jsx)("hr",{}),(0,a.jsxs)("div",{className:"two_header_content d-flex flex-wrap align-items-center mb-3 mt-4",children:[(0,a.jsx)("div",{className:"random_fees ",children:(0,a.jsxs)("p",{children:[(0,f.t)("entry_fees"),":"," ",(0,a.jsxs)("span",{children:[eo," ","",(0,f.t)("coins")]})]})}),(0,a.jsx)("div",{className:"random_current_coins",children:(0,a.jsxs)("p",{children:[(0,f.t)("current_coins"),":",(0,a.jsxs)("span",{children:[K," ",(0,f.t)("coins")]})]})})]}),(0,a.jsxs)("div",{className:"bottom__cat__box",children:[(()=>{if(A&&"1"==A.battle_mode_random_category)return(0,a.jsx)("div",{className:"seleterWrapper",children:(0,a.jsx)(i.Z.Select,{"aria-label":"Default select example",size:"lg",className:"selectform",onChange:e=>ei(e),children:D?(0,a.jsx)("option",{children:(0,f.t)("loading")}):(0,a.jsx)(a.Fragment,{children:R.all?R.all.map((e,t)=>{let{category_name:r}=e;return(0,a.jsx)("option",{name:e.category_name,value:e.key,id:e.id,no_of:e.no_of,children:r},t)}):(0,a.jsx)("option",{children:(0,f.t)("no_cat_data_found")})})})})})(),(0,a.jsx)("div",{className:"random_play",children:(0,a.jsx)("button",{type:"submit",className:"btn btn-primary",onClick:()=>eg(),children:(0,f.t)("play_now")})})]})]})})}):null,(null==A?void 0:A.battle_mode_one)==="1"?(0,a.jsx)("div",{className:"col-md-12 col-lg-6 col-12",children:(0,a.jsx)("div",{className:"left_content",children:(0,a.jsxs)("div",{className:"left-sec right_content",children:[(0,a.jsx)("h3",{className:" mb-3 leftSecTite",children:(0,f.t)("play_with_friend")}),(0,a.jsx)("hr",{}),(0,a.jsx)("div",{className:"two_header_content d-flex flex-wrap align-items-center mb-3 mt-4",children:(0,a.jsx)("div",{className:"playFrdPara",children:(0,a.jsx)("p",{children:(0,f.t)("play_frd_para")})})}),(0,a.jsx)("div",{className:"bottom__cat__box",children:(0,a.jsx)("div",{className:"random_play",children:(0,a.jsx)("button",{className:"btn btn-primary",onClick:()=>eN(!0),children:(0,f.t)("play_with_friend")})})})]})})}):null]})})})}),(0,a.jsx)(d.Z,{centered:!0,maskClosable:!1,open:H,onOk:()=>q(!1),onCancel:()=>{ew(),q(!1)},footer:null,className:"custom_modal_notify retry-modal",children:H?(0,a.jsx)(a.Fragment,{children:(0,a.jsxs)("div",{className:"nouser d-flex justify-content-center align-items-center flex-column",children:[(0,a.jsxs)("h5",{className:" text-center",children:[(0,f.t)("no_opponent_detected")," ",(0,a.jsx)("br",{})]}),(0,a.jsx)("button",{className:"btn btn-primary mt-2",onClick:()=>eb(),children:(0,f.t)("play_with_bot")}),(0,a.jsx)("button",{className:"btn btn-primary mt-2",onClick:()=>ej(),children:(0,f.t)("retry")})]})}):""})]})})}}]);